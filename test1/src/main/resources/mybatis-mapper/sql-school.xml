<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.test1.mapper.SchoolMapper">
	<select id="selectSchoolList" parameterType="hashmap" resultType="com.example.test1.model.School">
		SELECT 
		STUNO, NAME as name, RPAD(SUBSTR(ID, 1, LENGTH(ID)-3), LENGTH(ID), '*') as ID, GRADE,
		substr(JUMIN, 1, 6) || '-' || SUBSTR(JUMIN, 7, 1) || '******' as JUMIN
		FROM STU
	</select>
	
	<select id="selectSchoolCnt" parameterType="hashmap" resultType="int">
		select count(*) as CNT
		from stu
	</select>
	
	<select id="selectSchoolInfo" parameterType="hashmap" resultType="com.example.test1.model.School">
		SELECT S.STUNO AS STUNO, S.NAME AS NAME, D1.DNAME AS D1DNAME, D2.DNAME AS D2DNAME, P.NAME AS PNAME
		FROM STU S INNER JOIN PROFESSOR P
		ON S.PROFNO = p.profno
		INNER JOIN DEPARTMENT D1
		ON S.DEPTNO1 = D1.DEPTNO
		INNER JOIN DEPARTMENT D2
		ON D1.PART = d2.DEPTNO
		where stuNo = #{stuNo}
	</select>
	
	<delete id="deleteSchool" parameterType="hashmap">
		DELETE 
		FROM STU
		WHERE STUNO = #{stuNo}
	</delete>
	
	<insert id="insertSchool" parameterType="hashmap">
		INSERT INTO STU(STUNO, NAME, ID, GRADE, JUMIN, DEPTNO1) 
		VALUES(#{stuNo}, #{name}, #{id}, #{grade}, #{jumin}, #{deptno1})
	</insert>
	
	
	
	
</mapper>




